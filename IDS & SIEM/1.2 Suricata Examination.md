## Configuring Suricata and Using it to Trigger Alerts. 

## Task 1. Examining a Custom Rule in Suricata

![chrome_wQ9p61CyjX](https://github.com/Kwangsa19/Ketmanto-Cybersecurity-Portfolio/assets/135963482/2c776e7c-9af7-415e-bdfd-9c859b3c6a05)

```
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"GET on wire"; flow:established,to_server; content:"GET"; http_method; sid:12345; rev:3;)
```

* Action
`Alert` : Instructs to alert on selected network traffic. The IDS will inspect the traffic packets and send out an alert in case it matches. 

* Header
`http`: The rule that applies is only to HTTP traffic. The arrow indicates the direction of the traffic from $HOME_NET and going to the destination IP address $EXTERNAL_NET. In this scenario, $HOME_NET is a suricata variable defined in `/etc/suricata/suricata/yaml` as a rule definitions.
$HOME_NET is definatd as the `172.21.224/0/20` subnet. 

* Rule options
`Rule`: Customize signatures with additional parameters.
  * The `msg`: The alert will print out the text `GET on wire`.
  * The `flow:established, to_server`: Determines that packet from the client to the server should be matched (The handshakes: SYN-ACK packet).
  * The `content`: "GET" tells Suricata to look for the word GET in the `http.method` of the packet.
  * The `sid:12345`: Unique numerical value that identify the rule.
  * The `rev:3` indicates the signature's version which is used to identify the signature's version.  

2. Trigger a custom rule in Suricata.
* List the files in the `/var/log/suricata` folder: `ls -l /var/log/suricata`. Up this task, there will be no files to be found. 

![chrome_cZ26BKgmAo](https://github.com/Kwangsa19/Ketmanto-Cybersecurity-Portfolio/assets/135963482/0ad29868-693c-4d87-afd8-5a4deffcd37d)

* We run Suricata using the `custom.rules` and `sample.pcap`: `sudo suricata -r sample.pcap -S custom.rules -k none`.
  * The `-r sample.pcap` option specifies an input file to mimic network traffic. In this case, the sample.pcap file.
  * The `-S custom.rules` option instructs Suricata to use the rules defined in the custom.rules file.
  * The `-k none` option instructs Suricata to disable all checksum checks.

![chrome_T7TLuD7CeL](https://github.com/Kwangsa19/Ketmanto-Cybersecurity-Portfolio/assets/135963482/2372e192-2be1-48fd-9e1d-e4b7b10c34d2)

* List the files in the `/var/log/suricata` folder again: `ls -l /var/log/suricata`.

![chrome_LDJhBLOBkx](https://github.com/Kwangsa19/Ketmanto-Cybersecurity-Portfolio/assets/135963482/62961a88-2616-4f53-8adc-1d3d4d51adf8)

* Display `fast.log`: `cat /var/log/suricata/fast.log`

![chrome_GCOEhLYHp9](https://github.com/Kwangsa19/Ketmanto-Cybersecurity-Portfolio/assets/135963482/52c12462-450d-4f66-bcdf-669236ab5e88)

Here, each line corresponds to an alert generated by Suricata when it processes a packet that meets the conditions of an alert generating rule. Each line consists of the rule triggered the alert, source, destination and direction of the traffic. 


3. Examine `eve.json` output.
* Use the cat command to display the entries in the `eve.json` file: `cat /var/log/suricata/eve.json`. The format of the data will be in JSON. 

![chrome_r3t4Hi4QtK](https://github.com/Kwangsa19/Ketmanto-Cybersecurity-Portfolio/assets/135963482/11037f36-0dd3-4096-92a3-5460ab42dbf4)

* Let's display the entries in an improved format: `jq . /var/log/suricata/eve/json | less`.

![chrome_9a3WCOAcTe](https://github.com/Kwangsa19/Ketmanto-Cybersecurity-Portfolio/assets/135963482/775c44db-f4c1-4bc9-8d02-b6ebb2de9fc0)

* Extract specific event data from `eve.json` file: `jq -c "[.timestamp,.flow_id,.alert.signature,.proto,.dest_ip]" /var/log/suricata/eve.json`.
![chrome_BSvLHl2Ja8](https://github.com/Kwangsa19/Ketmanto-Cybersecurity-Portfolio/assets/135963482/7e921312-894c-409f-b606-1cf5facec14b)

> Press Q to exit the `less` command and return to the command-line prompt.

4. Several things to be found in the `eve.json`:
  * The value of the severity for the first alert returned by the `jq` command is 3.
  * The destination IP address listed for the last event in the `eve.json` file is `142.250.1.102`.
  * The alert signature for the first entry in the `eve.json` is `GET on WIRE`. 
